{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/yeldos.k/Desktop/final-map-app/client/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/yeldos.k/Desktop/final-map-app/client/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/yeldos.k/Desktop/final-map-app/client/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{useAddNewUserMutation}from\"./usersApiSlice\";import{ROLES}from\"../../config/roles\";import{useNavigate}from\"react-router\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var USER_REGEX=/^[A-z]{3,20}$/;var PWD_REGEX=/^[A-z0-9!@#$%]{4,12}$/;var NewUserForm=function NewUserForm(){var _useAddNewUserMutatio=useAddNewUserMutation(),_useAddNewUserMutatio2=_slicedToArray(_useAddNewUserMutatio,2),addNewUser=_useAddNewUserMutatio2[0],_useAddNewUserMutatio3=_useAddNewUserMutatio2[1],isLoading=_useAddNewUserMutatio3.isLoading,isSuccess=_useAddNewUserMutatio3.isSuccess,isError=_useAddNewUserMutatio3.isError,error=_useAddNewUserMutatio3.error;var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),validUsername=_useState4[0],setValidUsername=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),validPassword=_useState8[0],setValidPassword=_useState8[1];var _useState9=useState('Employee'),_useState10=_slicedToArray(_useState9,2),roles=_useState10[0],setRoles=_useState10[1];useEffect(function(){setValidUsername(USER_REGEX.test(username));},[username]);useEffect(function(){setValidPassword(PWD_REGEX.test(password));},[password]);useEffect(function(){if(isSuccess){setUsername('');setPassword('');setRoles([]);navigate('/dash/users');alert(\"Новый пользователь добавлен!\");}},[isSuccess,navigate]);var onUsernameChanged=function onUsernameChanged(e){return setUsername(e.target.value);};var onPasswordChanged=function onPasswordChanged(e){return setPassword(e.target.value);};var onRolesChanged=function onRolesChanged(e){var values=Array.from(e.target.selectedOptions,//HTMLCollection \nfunction(option){return option.value;});setRoles(values);};var canSave=[roles.length,validUsername,validPassword].every(Boolean)&&!isLoading;var onSaveUserClicked=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();if(!canSave){_context.next=4;break;}_context.next=4;return addNewUser({username:username,password:password,roles:roles});case 4:case\"end\":return _context.stop();}},_callee);}));return function onSaveUserClicked(_x){return _ref.apply(this,arguments);};}();var options=Object.values(ROLES).map(function(role){return/*#__PURE__*/_jsxs(\"option\",{value:role,children:[\" \",role]},role);});var errClass=isError?\"errmsg\":\"offscreen\";var validUserClass=!validUsername?'form__input--incomplete':'';var validPwdClass=!validPassword?'form__input--incomplete':'';var validRolesClass=!Boolean(roles.length)?'form__input--incomplete':'';return/*#__PURE__*/_jsx(\"div\",{className:\"full\",children:/*#__PURE__*/_jsx(\"div\",{className:\"signupScreen\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:onSaveUserClicked,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form__title-row\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"save_button\",title:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\",disabled:!canSave,children:\"C\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"label\",{className:\"title\",htmlFor:\"username\",children:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"inputsave \".concat(validUserClass),id:\"username\",name:\"username\",type:\"text\",autoComplete:\"off\",value:username,onChange:onUsernameChanged}),/*#__PURE__*/_jsx(\"label\",{className:\"title\",htmlFor:\"password\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C: \"}),/*#__PURE__*/_jsx(\"input\",{className:\"inputsave \".concat(validPwdClass),id:\"password\",name:\"password\",type:\"password\",value:password,onChange:onPasswordChanged}),/*#__PURE__*/_jsx(\"label\",{className:\"title\",htmlFor:\"roles\",children:\"\\u041D\\u0410\\u0417\\u041D\\u0410\\u0427\\u0415\\u041D\\u041D\\u042B\\u0415 \\u0420\\u041E\\u041B\\u0418:\"}),/*#__PURE__*/_jsx(\"select\",{id:\"roles\",name:\"roles\",className:\"inputsave \".concat(validRolesClass),multiple:true,size:\"3\",value:roles,onChange:onRolesChanged,children:options})]})})});};export default NewUserForm;","map":{"version":3,"names":["useState","useEffect","useAddNewUserMutation","ROLES","useNavigate","jsxs","_jsxs","jsx","_jsx","USER_REGEX","PWD_REGEX","NewUserForm","_useAddNewUserMutatio","_useAddNewUserMutatio2","_slicedToArray","addNewUser","_useAddNewUserMutatio3","isLoading","isSuccess","isError","error","navigate","_useState","_useState2","username","setUsername","_useState3","_useState4","validUsername","setValidUsername","_useState5","_useState6","password","setPassword","_useState7","_useState8","validPassword","setValidPassword","_useState9","_useState10","roles","setRoles","test","alert","onUsernameChanged","e","target","value","onPasswordChanged","onRolesChanged","values","Array","from","selectedOptions","option","canSave","length","every","Boolean","onSaveUserClicked","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","preventDefault","stop","_x","apply","arguments","options","Object","map","role","children","errClass","validUserClass","validPwdClass","validRolesClass","className","onSubmit","title","disabled","htmlFor","concat","id","name","type","autoComplete","onChange","multiple","size"],"sources":["C:/Users/yeldos.k/Desktop/final-map-app/client/client/src/features/users/NewUserForm.js"],"sourcesContent":["import { useState, useEffect } from \"react\"\r\nimport { useAddNewUserMutation } from \"./usersApiSlice\"\r\nimport { ROLES } from \"../../config/roles\"\r\nimport { useNavigate } from \"react-router\"\r\n\r\nconst USER_REGEX = /^[A-z]{3,20}$/\r\nconst PWD_REGEX = /^[A-z0-9!@#$%]{4,12}$/\r\n\r\nconst NewUserForm = () => {\r\n\r\n    const  [addNewUser, {\r\n        isLoading, \r\n        isSuccess,\r\n        isError,\r\n        error\r\n    }] = useAddNewUserMutation()\r\n\r\n    const navigate = useNavigate()\r\n\r\n    const [username, setUsername] = useState('')\r\n    const [validUsername, setValidUsername] = useState(false)\r\n    const [password, setPassword] = useState('')\r\n    const [validPassword, setValidPassword] = useState(false)\r\n    const [roles, setRoles] = useState('Employee')\r\n\r\n    useEffect(() => {\r\n        setValidUsername(USER_REGEX.test(username))\r\n    }, [username])\r\n\r\n    useEffect(() => {\r\n        setValidPassword(PWD_REGEX.test(password))\r\n    }, [password])\r\n\r\n    useEffect(() => {\r\n        if (isSuccess) {\r\n            setUsername('')\r\n            setPassword('')\r\n            setRoles([])\r\n            navigate('/dash/users')\r\n            alert(\"Новый пользователь добавлен!\")\r\n        }\r\n    }, [isSuccess, navigate])\r\n\r\n    const onUsernameChanged = e => setUsername(e.target.value)\r\n    const onPasswordChanged = e => setPassword(e.target.value)\r\n\r\n    const onRolesChanged = e => {\r\n        const values = Array.from(\r\n            e.target.selectedOptions, //HTMLCollection \r\n            (option) => option.value\r\n        )\r\n        setRoles(values)\r\n    }\r\n\r\n    const canSave = [roles.length, validUsername, validPassword].every(Boolean) && !isLoading\r\n\r\n    const onSaveUserClicked = async (e) => {\r\n        e.preventDefault()\r\n        if (canSave) {\r\n            await addNewUser({ username, password, roles })\r\n        }\r\n    }\r\n\r\n    const options = Object.values(ROLES).map(role => {\r\n        return (\r\n            <option\r\n                key={role}\r\n                value={role}\r\n\r\n            > {role}</option >\r\n        )\r\n    })\r\n\r\n    const errClass = isError ? \"errmsg\" : \"offscreen\"\r\n    const validUserClass = !validUsername ? 'form__input--incomplete' : ''\r\n    const validPwdClass = !validPassword ? 'form__input--incomplete' : ''\r\n    const validRolesClass = !Boolean(roles.length) ? 'form__input--incomplete' : ''\r\n\r\n\r\n\r\n  return (\r\n    <div className='full'>\r\n        <div className='signupScreen'>\r\n            <form className=\"form\" onSubmit={onSaveUserClicked}>\r\n                <div className=\"form__title-row\">\r\n                    <h2>Новый пользователь</h2>\r\n                    \r\n                        <button\r\n                            className=\"save_button\"\r\n                            title=\"Сохранить\"\r\n                            disabled={!canSave}\r\n                        >\r\n                           Cохранить \r\n                        </button>\r\n                    \r\n                </div>\r\n                <label className='title' htmlFor=\"username\">\r\n                    Имя пользователя: </label>\r\n                <input\r\n                    className={`inputsave ${validUserClass}`}\r\n                    id=\"username\"\r\n                    name=\"username\"\r\n                    type=\"text\"\r\n                    autoComplete=\"off\"\r\n                    value={username}\r\n                    onChange={onUsernameChanged}\r\n                />\r\n\r\n                <label className='title' htmlFor=\"password\">\r\n                    Пароль: </label>\r\n                <input\r\n                    className={`inputsave ${validPwdClass}`}\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    value={password}\r\n                    onChange={onPasswordChanged}\r\n                />\r\n\r\n                <label className='title' htmlFor=\"roles\">\r\n                    НАЗНАЧЕННЫЕ РОЛИ:</label>\r\n                <select\r\n                    id=\"roles\"\r\n                    name=\"roles\"\r\n                    className={`inputsave ${validRolesClass}`}\r\n                    multiple={true}\r\n                    size=\"3\"\r\n                    value={roles}\r\n                    onChange={onRolesChanged}\r\n                >\r\n                    {options}\r\n                </select>\r\n\r\n            </form>\r\n            </div>\r\n        </div>\r\n  )\r\n}\r\n\r\nexport default NewUserForm"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}